[["basic-usage.html", "Chapter 2 Basic usage 2.1 Classic visualization 2.2 Marking gene names 2.3 New style graphic 2.4 Add NES and Pvalue 2.5 Multiple terms GSEA plot 2.6 KEGG object with marking gene names", " Chapter 2 Basic usage GseaVis introduces classic gsea visualization and graphic in a new style. Users can create at a publication-quality level. 2.1 Classic visualization First we load example data: library(GseaVis) # load data test_data &lt;- system.file(&quot;extdata&quot;, &quot;gseaRes.RDS&quot;, package = &quot;GseaVis&quot;) gseaRes &lt;- readRDS(test_data) gseaRes # # Gene Set Enrichment Analysis # # # #...@organism UNKNOWN # #...@setType UNKNOWN # #...@geneList Named num [1:27970] 6.02 5.96 5.84 5.8 5.72 ... # - attr(*, &quot;names&quot;)= chr [1:27970] &quot;Ecscr&quot; &quot;Gm32341&quot; &quot;B130034C11Rik&quot; &quot;Hkdc1&quot; ... # #...nPerm # #...pvalues adjusted by &#39;BH&#39; with cutoff &lt;1 # #...4917 enriched terms found # &#39;data.frame&#39;: 4917 obs. of 11 variables: # $ ID : chr &quot;GOBP_REGULATION_OF_VASCULOGENESIS&quot; &quot;GOBP_AMEBOIDAL_TYPE_CELL_MIGRATION&quot; &quot;GOBP_REGULATION_OF_OSSIFICATION&quot; &quot;GOBP_NEGATIVE_REGULATION_OF_EPITHELIAL_CELL_PROLIFERATION&quot; ... # $ Description : chr &quot;GOBP_REGULATION_OF_VASCULOGENESIS&quot; &quot;GOBP_AMEBOIDAL_TYPE_CELL_MIGRATION&quot; &quot;GOBP_REGULATION_OF_OSSIFICATION&quot; &quot;GOBP_NEGATIVE_REGULATION_OF_EPITHELIAL_CELL_PROLIFERATION&quot; ... # $ setSize : int 14 382 106 110 322 209 228 278 11 34 ... # $ enrichmentScore: num 0.803 -0.345 -0.461 -0.456 -0.346 ... # $ NES : num 1.85 -1.39 -1.61 -1.58 -1.36 ... # $ pvalue : num 0.000273 0.00051 0.000528 0.000543 0.000853 ... # $ p.adjust : num 0.667 0.667 0.667 0.667 0.686 ... # $ qvalues : num 0.667 0.667 0.667 0.667 0.686 ... # $ rank : num 1515 7626 6611 7802 7751 ... # $ leading_edge : chr &quot;tags=29%, list=5%, signal=27%&quot; &quot;tags=36%, list=27%, signal=27%&quot; &quot;tags=39%, list=24%, signal=30%&quot; &quot;tags=42%, list=28%, signal=30%&quot; ... # $ core_enrichment: chr &quot;Adm/Ramp2/Hey2/Asb4&quot; &quot;Akap12/Ceacam1/Zeb2/Foxp1/Efnb2/Tpbg/Hyal1/Mmp9/Slc8a1/Pfn2/Ltb4r2/Ilk/Bcar1/Gipc1/Plpp3/Arhgef7/Prkx/Epha2/Hda&quot;| __truncated__ &quot;Ddr2/Ifitm5/S1pr1/Tgfb1/Intu/Sox11/Bmp7/Bmpr2/Mdk/Smad3/Fbn2/Tent5a/Adgrv1/Calca/Matn1/Enpp1/Twist1/Alox5/Ccn1/&quot;| __truncated__ &quot;Sparc/Tgfbr3/Ift172/Flt1/Sfrp2/Ceacam1/Pex2/Cdkn1b/Maged1/Efnb2/Klf9/Sfn/Nupr1/Aqp11/Tgfb2/Robo1/Tgfb1/Nr2f2/Rb&quot;| __truncated__ ... # #...Citation # T Wu, E Hu, S Xu, M Chen, P Guo, Z Dai, T Feng, L Zhou, W Tang, L Zhan, X Fu, S Liu, X Bo, and G Yu. # clusterProfiler 4.0: A universal enrichment tool for interpreting omics data. # The Innovation. 2021, 2(3):100141 Classic plot: # all plot gseaNb(object = gseaRes, geneSetID = &#39;GOBP_NUCLEOSIDE_DIPHOSPHATE_METABOLIC_PROCESS&#39;) Using subPlot to retain curve plot: # retain curve gseaNb(object = gseaRes, geneSetID = &#39;GOBP_NUCLEOSIDE_DIPHOSPHATE_METABOLIC_PROCESS&#39;, subPlot = 1) Retain heatmap and curve: # retain curve and heatmap gseaNb(object = gseaRes, geneSetID = &#39;GOBP_NUCLEOSIDE_DIPHOSPHATE_METABOLIC_PROCESS&#39;, subPlot = 2) You can define the term width when it is to long: # wrap the term title gseaNb(object = gseaRes, geneSetID = &#39;GOBP_NUCLEOSIDE_DIPHOSPHATE_METABOLIC_PROCESS&#39;, subPlot = 2, termWidth = 30) 2.2 Marking gene names At some scenario, you may want to highlight some interested genes in the term and show which position they are: # add gene in specific pathway mygene &lt;- c(&quot;Entpd8&quot;,&quot;Htr2a&quot;,&quot;Nt5e&quot;,&quot;Actn3&quot;,&quot;Entpd1&quot;, &quot;Pfkp&quot;, &quot;Tpi1&quot;,&quot;Igf1&quot;,&quot;Ddit4&quot;,&quot;Ak9&quot;) # plot gseaNb(object = gseaRes, geneSetID = &#39;GOBP_NUCLEOSIDE_DIPHOSPHATE_METABOLIC_PROCESS&#39;, subPlot = 2, addGene = mygene) You can change gene color and arrow type: # change gene color and arrow type gseaNb(object = gseaRes, geneSetID = &#39;GOBP_NUCLEOSIDE_DIPHOSPHATE_METABOLIC_PROCESS&#39;, subPlot = 2, addGene = mygene, arrowType = &#39;open&#39;, geneCol = &#39;black&#39;) Whole plot with marked gene: # all plot gseaNb(object = gseaRes, geneSetID = &#39;GOBP_NUCLEOSIDE_DIPHOSPHATE_METABOLIC_PROCESS&#39;, subPlot = 3, addGene = mygene, rmSegment = TRUE) 2.3 New style graphic Here we introduce a new style plot with mergeing gene rank plot into the curve plot: # new style GSEA gseaNb(object = gseaRes, geneSetID = &#39;GOBP_NUCLEOSIDE_DIPHOSPHATE_METABOLIC_PROCESS&#39;, newGsea = T) Remove the points for each vertical segemnt: # new style GSEA remove point gseaNb(object = gseaRes, geneSetID = &#39;GOBP_NUCLEOSIDE_DIPHOSPHATE_METABOLIC_PROCESS&#39;, newGsea = T, addPoint = F) Change the heatmap color: # change heatmap color gseaNb(object = gseaRes, geneSetID = &#39;GOBP_NUCLEOSIDE_DIPHOSPHATE_METABOLIC_PROCESS&#39;, newGsea = T, addPoint = F, newHtCol = c(&quot;blue&quot;,&quot;white&quot;, &quot;red&quot;)) You can also label your interested gene: # new style GSEA with gene name gseaNb(object = gseaRes, geneSetID = &#39;GOBP_NUCLEOSIDE_DIPHOSPHATE_METABOLIC_PROCESS&#39;, newGsea = T, addGene = mygene) Remove red segemnt: # remove red segment gseaNb(object = gseaRes, geneSetID = &#39;GOBP_NUCLEOSIDE_DIPHOSPHATE_METABOLIC_PROCESS&#39;, newGsea = T, rmSegment = T, addGene = mygene) Remove heatmap: # remove heatmap gseaNb(object = gseaRes, geneSetID = &#39;GOBP_NUCLEOSIDE_DIPHOSPHATE_METABOLIC_PROCESS&#39;, newGsea = T, rmSegment = T, rmHt = T, addGene = mygene) 2.4 Add NES and Pvalue Sometimes you need to add NES score and Pvalue to interpret the termâ€™s significance: # add pvalue and NES gseaNb(object = gseaRes, geneSetID = &#39;GOBP_NUCLEOSIDE_DIPHOSPHATE_METABOLIC_PROCESS&#39;, newGsea = T, addGene = mygene, addPval = T) Adjust the relative position: # control label ajustment gseaNb(object = gseaRes, geneSetID = &#39;GOBP_NUCLEOSIDE_DIPHOSPHATE_METABOLIC_PROCESS&#39;, newGsea = T, addGene = mygene, addPval = T, pvalX = 0.75,pvalY = 0.8, pCol = &#39;black&#39;, pHjust = 0) The classic plot with NES and pvalue annotation: # clsaasic with pvalue gseaNb(object = gseaRes, geneSetID = &#39;GOBP_NUCLEOSIDE_DIPHOSPHATE_METABOLIC_PROCESS&#39;, addGene = mygene, addPval = T, pvalX = 0.75,pvalY = 0.8, pCol = &#39;black&#39;, pHjust = 0) 2.5 Multiple terms GSEA plot Multiple terms can be drawn in a single plot or using a for loop. # bacth plot terms &lt;- c(&#39;GOBP_NUCLEOSIDE_DIPHOSPHATE_METABOLIC_PROCESS&#39;, &#39;GOBP_REGULATION_OF_OSSIFICATION&#39;, &#39;GOBP_TISSUE_MIGRATION&#39;, &#39;GOBP_CELL_MATRIX_ADHESION&#39;) # plot lapply(terms, function(x){ gseaNb(object = gseaRes, geneSetID = x, addPval = T, pvalX = 0.75,pvalY = 0.75, pCol = &#39;black&#39;, pHjust = 0) }) -&gt; gseaList # combine cowplot::plot_grid(plotlist = gseaList,ncol = 2,align = &#39;hv&#39;) Combine into a single plot: geneSetID = c(&#39;GOBP_NUCLEOSIDE_DIPHOSPHATE_METABOLIC_PROCESS&#39;, &#39;GOBP_REGULATION_OF_OSSIFICATION&#39;, &#39;GOBP_TISSUE_MIGRATION&#39;) # all plot gseaNb(object = gseaRes, geneSetID = geneSetID) Retain curve and heatmap: # sub plot gseaNb(object = gseaRes, geneSetID = geneSetID, subPlot = 2) Remove heatmap: # remove heatbar gseaNb(object = gseaRes, geneSetID = geneSetID, subPlot = 2, rmHt = T) Wrap term name and adjust legend position: # wrap term name and adjust position gseaNb(object = gseaRes, geneSetID = geneSetID, subPlot = 2, termWidth = 35, legend.position = c(0.5,0.7)) Add gene names: # add gene name gene &lt;- c(&quot;Entpd8&quot;,&quot;Htr2a&quot;,&quot;Nt5e&quot;,&quot;Actn3&quot;,&quot;Entpd1&quot;, &quot;Pfkp&quot;, &quot;Tpi1&quot;,&quot;Igf1&quot;,&quot;Ddit4&quot;,&quot;Ak9&quot;) gseaNb(object = gseaRes, geneSetID = geneSetID, subPlot = 2, termWidth = 35, legend.position = c(0.8,0.8), addGene = gene) Add NES and pvalue: # add NES and Pvalue gseaNb(object = gseaRes, geneSetID = geneSetID, subPlot = 2, termWidth = 35, legend.position = c(0.8,0.8), addGene = gene, addPval = T, pvalX = 0.05,pvalY = 0.05) Change color: # change line color gseaNb(object = gseaRes, geneSetID = geneSetID, subPlot = 2, termWidth = 35, legend.position = c(0.65,0.8), addGene = gene, addPval = T, pvalX = 0.05,pvalY = 0.05, curveCol = jjAnno::useMyCol(&#39;paired&#39;,3)) A facet style plot: # load data test_data &lt;- system.file(&quot;extdata&quot;, &quot;gseaRes.RDS&quot;, package = &quot;GseaVis&quot;) gseaRes &lt;- readRDS(test_data) setid &lt;- c(&quot;GOBP_REGULATION_OF_OSTEOCLAST_DIFFERENTIATION&quot;, &quot;GOBP_NEGATIVE_REGULATION_OF_MYELOID_CELL_DIFFERENTIATION&quot;, &quot;GOBP_REGULATION_OF_NEURON_MIGRATION&quot;, &quot;GOBP_POSITIVE_REGULATION_OF_TYPE_I_INTERFERON_PRODUCTION&quot;, &quot;GOBP_POLYSACCHARIDE_BIOSYNTHETIC_PROCESS&quot;) gseaNb(object = gseaRes, geneSetID = setid, newGsea = T, rmHt = T) Control term label width: gseaNb(object = gseaRes, geneSetID = setid, newGsea = T, rmHt = T, termWidth = 20) Retain Y axis: gseaNb(object = gseaRes, geneSetID = setid, newGsea = T, rmHt = T, rm.newGsea.ticks = F) Add pvalue and NES: gseaNb(object = gseaRes, geneSetID = setid, newGsea = T, addPval = T, rmHt = T, pvalX = 0.9, pvalY = 0.5, pFill = &quot;white&quot;) Add top gene labels: gseaNb(object = gseaRes, geneSetID = setid, newGsea = T, addPval = T, rmHt = T, pvalX = 0.8, pvalY = 0.5, pFill = &quot;white&quot;, addGene = T, markTopgene = T, geneCol = &quot;#009933&quot;) Change curve colors: setid2 &lt;- c(&quot;GOBP_POSITIVE_REGULATION_OF_MUSCLE_HYPERTROPHY&quot;, &quot;GOBP_BIOLOGICAL_PROCESS_INVOLVED_IN_INTERACTION_WITH_SYMBIONT&quot;, &quot;GOBP_POSITIVE_REGULATION_OF_LEUKOCYTE_MIGRATION&quot;, &quot;GOBP_REGULATION_OF_MACROPHAGE_DIFFERENTIATION&quot;, &quot;GOBP_METANEPHRIC_NEPHRON_MORPHOGENESIS&quot;) gseaNb(object = gseaRes, geneSetID = setid2, newGsea = T, addPval = T, rmHt = T, pvalX = 0.8, pvalY = 0.5, pFill = &quot;transparent&quot;, addGene = T, markTopgene = T, geneCol = &quot;#009933&quot;, newCurveCol = rainbow(7)) 2.6 KEGG object with marking gene names You need use setReadable function to transform ENTEZID into SYMBOL and set kegg = T: library(clusterProfiler) library(org.Hs.eg.db) library(enrichplot) library(GseaVis) # load test data data(geneList, package=&quot;DOSE&quot;) # check head(geneList) # 4312 8318 10874 55143 55388 991 # 4.572613 4.514594 4.418218 4.144075 3.876258 3.677857 # KEGG enrich kk2 &lt;- gseKEGG(geneList = geneList, organism = &#39;hsa&#39;, minGSSize = 120, pvalueCutoff = 0.05, verbose = FALSE) # transform entrizid to gene symbol kk2 &lt;- setReadable(kk2, OrgDb = &quot;org.Hs.eg.db&quot;, keyType = &quot;ENTREZID&quot;) gseaNb(object = kk2, geneSetID = &#39;hsa05169&#39;, subPlot = 2, addGene = T, kegg = T, markTopgene = T) "],["404.html", "Page not found", " Page not found The page you requested cannot be found (perhaps it was moved or renamed). You may want to try searching to find the page's new location, or use the table of contents to find the page you are looking for. "]]
